CREATE DATABASE  IF NOT EXISTS `newsagency` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION='N' */;
USE `newsagency`;
-- MySQL dump 10.13  Distrib 8.0.18, for Win64 (x86_64)
--
-- Host: 127.0.0.1    Database: newsagency
-- ------------------------------------------------------
-- Server version	8.0.18

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `finance`
--

DROP TABLE IF EXISTS `finance`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `finance` (
  `finance_id` int(9) NOT NULL,
  `djia_date` date DEFAULT NULL,
  `djia_returns` decimal(10,2) DEFAULT NULL,
  PRIMARY KEY (`finance_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `finance`
--

LOCK TABLES `finance` WRITE;
/*!40000 ALTER TABLE `finance` DISABLE KEYS */;
INSERT INTO `finance` VALUES (1,'2017-01-03',19881.76),(2,'2017-01-04',19942.16),(3,'2017-01-05',19899.29),(4,'2017-01-06',19963.80),(5,'2017-01-09',19887.38),(6,'2017-01-10',19855.53),(7,'2017-01-11',19954.28),(8,'2017-01-12',19891.00),(9,'2017-01-13',19885.73),(10,'2017-01-17',19826.77),(11,'2017-01-18',19804.72),(12,'2017-01-19',19732.40),(13,'2017-01-20',19827.25),(14,'2017-01-23',19799.85),(15,'2017-01-24',19912.71),(16,'2017-01-25',20068.51),(17,'2017-01-26',20100.91),(18,'2017-01-27',20093.78),(19,'2017-01-30',19971.13),(20,'2017-01-31',19864.09),(21,'2017-02-01',19890.94),(22,'2017-02-02',19884.91),(23,'2017-02-03',20071.46),(24,'2017-02-06',20052.42),(25,'2017-02-07',20090.29),(26,'2017-02-08',20054.34),(27,'2017-02-09',20172.40),(28,'2017-02-10',20269.37),(29,'2017-02-13',20412.16),(30,'2017-02-14',20504.41),(31,'2017-02-15',20611.86),(32,'2017-02-16',20619.77),(33,'2017-02-17',20624.05),(34,'2017-02-21',20743.00),(35,'2017-02-22',20775.60),(36,'2017-02-23',20810.32),(37,'2017-02-24',20821.76),(38,'2017-02-27',20837.44),(39,'2017-02-28',20812.24),(40,'2017-03-01',21115.55),(41,'2017-03-02',21002.97),(42,'2017-03-03',21005.71),(43,'2017-03-06',20954.34),(44,'2017-03-07',20924.76),(45,'2017-03-08',20855.73),(46,'2017-03-09',20858.19),(47,'2017-03-10',20902.98),(48,'2017-03-13',20881.48),(49,'2017-03-14',20837.37),(50,'2017-03-15',20950.10),(51,'2017-03-16',20934.55),(52,'2017-03-17',20914.62),(53,'2017-03-20',20905.86),(54,'2017-03-21',20668.01),(55,'2017-03-22',20661.30),(56,'2017-03-23',20656.58),(57,'2017-03-24',20596.72),(58,'2017-03-27',20550.98),(59,'2017-03-28',20701.50),(60,'2017-03-29',20659.32),(61,'2017-03-30',20728.49),(62,'2017-03-31',20663.22),(63,'2017-04-03',20650.21),(64,'2017-04-04',20689.24),(65,'2017-04-05',20648.15),(66,'2017-04-06',20662.95),(67,'2017-04-07',20656.10),(68,'2017-04-10',20658.02),(69,'2017-04-11',20651.30),(70,'2017-04-12',20591.86),(71,'2017-04-13',20453.25),(72,'2017-04-17',20636.92),(73,'2017-04-18',20523.28),(74,'2017-04-19',20404.49),(75,'2017-04-20',20578.71),(76,'2017-04-21',20547.76),(77,'2017-04-24',20763.89),(78,'2017-04-25',20996.12),(79,'2017-04-26',20975.09),(80,'2017-04-27',20981.33),(81,'2017-04-28',20940.51),(82,'2017-05-01',20913.46),(83,'2017-05-02',20949.89),(84,'2017-05-03',20957.90),(85,'2017-05-04',20951.47),(86,'2017-05-05',21006.94),(87,'2017-05-08',21012.28),(88,'2017-05-09',20975.78),(89,'2017-05-10',20943.11),(90,'2017-05-11',20919.42),(91,'2017-05-12',20896.61),(92,'2017-05-15',20981.94),(93,'2017-05-16',20979.75),(94,'2017-05-17',20606.93),(95,'2017-05-18',20663.02),(96,'2017-05-19',20804.84),(97,'2017-05-22',20894.83),(98,'2017-05-23',20937.91),(99,'2017-05-24',21012.42),(100,'2017-05-25',21082.95),(101,'2017-05-26',21080.28),(102,'2017-05-30',21029.47),(103,'2017-05-31',21008.65),(104,'2017-06-01',21144.18),(105,'2017-06-02',21206.29),(106,'2017-06-05',21184.04),(107,'2017-06-06',21136.23),(108,'2017-06-07',21173.69),(109,'2017-06-08',21182.53),(110,'2017-06-09',21271.97),(111,'2017-06-12',21235.67),(112,'2017-06-13',21328.47),(113,'2017-06-14',21374.56),(114,'2017-06-15',21359.90),(115,'2017-06-16',21384.28),(116,'2017-06-19',21528.99),(117,'2017-06-20',21467.14),(118,'2017-06-21',21410.03),(119,'2017-06-22',21397.29),(120,'2017-06-23',21394.76),(121,'2017-06-26',21409.55),(122,'2017-06-27',21310.66),(123,'2017-06-28',21454.61),(124,'2017-06-29',21287.03),(125,'2017-06-30',21349.63),(126,'2017-07-03',21479.27),(127,'2017-07-05',21478.17),(128,'2017-07-06',21320.04),(129,'2017-07-07',21414.34),(130,'2017-07-10',21408.52),(131,'2017-07-11',21409.07),(132,'2017-07-12',21532.14),(133,'2017-07-13',21553.09),(134,'2017-07-14',21637.74),(135,'2017-07-17',21629.72),(136,'2017-07-18',21574.73),(137,'2017-07-19',21640.75),(138,'2017-07-20',21611.78),(139,'2017-07-21',21580.07),(140,'2017-07-24',21513.17),(141,'2017-07-25',21613.43),(142,'2017-07-26',21711.01),(143,'2017-07-27',21796.55),(144,'2017-07-28',21830.31),(145,'2017-07-31',21891.12),(146,'2017-08-01',21963.92),(147,'2017-08-02',22016.24),(148,'2017-08-03',22026.10),(149,'2017-08-04',22092.81),(150,'2017-08-07',22118.42),(151,'2017-08-08',22085.34),(152,'2017-08-09',22048.70),(153,'2017-08-10',21844.01),(154,'2017-08-11',21858.32),(155,'2017-08-14',21993.71),(156,'2017-08-15',21998.99),(157,'2017-08-16',22024.87),(158,'2017-08-17',21750.73),(159,'2017-08-18',21674.51),(160,'2017-08-21',21703.75),(161,'2017-08-22',21899.89),(162,'2017-08-23',21812.09),(163,'2017-08-24',21783.40),(164,'2017-08-25',21813.67),(165,'2017-08-28',21808.40),(166,'2017-08-29',21865.37),(167,'2017-08-30',21892.43),(168,'2017-08-31',21948.10),(169,'2017-09-01',21987.56),(170,'2017-09-05',21753.31),(171,'2017-09-06',21807.64),(172,'2017-09-07',21784.78),(173,'2017-09-08',21797.79),(174,'2017-09-11',22057.37),(175,'2017-09-12',22118.86),(176,'2017-09-13',22158.18),(177,'2017-09-14',22203.48),(178,'2017-09-15',22268.34),(179,'2017-09-18',22331.35),(180,'2017-09-19',22370.80),(181,'2017-09-20',22412.59),(182,'2017-09-21',22359.23),(183,'2017-09-22',22349.59),(184,'2017-09-25',22296.09),(185,'2017-09-26',22284.32),(186,'2017-09-27',22340.71),(187,'2017-09-28',22381.20),(188,'2017-09-29',22405.09),(189,'2017-10-02',22557.60),(190,'2017-10-03',22641.67),(191,'2017-10-04',22661.64),(192,'2017-10-05',22775.39),(193,'2017-10-06',22773.67),(194,'2017-10-09',22761.07),(195,'2017-10-10',22830.68),(196,'2017-10-11',22872.89),(197,'2017-10-12',22841.01),(198,'2017-10-13',22871.72),(199,'2017-10-16',22956.96),(200,'2017-10-17',22997.44),(201,'2017-10-18',23157.60),(202,'2017-10-19',23163.04),(203,'2017-10-20',23328.63),(204,'2017-10-23',23273.96),(205,'2017-10-24',23441.76),(206,'2017-10-25',23329.46),(207,'2017-10-26',23400.86),(208,'2017-10-27',23434.19),(209,'2017-10-30',23348.74),(210,'2017-10-31',23377.24),(211,'2017-11-01',23435.01),(212,'2017-11-02',23516.26),(213,'2017-11-03',23539.19),(214,'2017-11-06',23548.42),(215,'2017-11-07',23557.23),(216,'2017-11-08',23563.36),(217,'2017-11-09',23461.94),(218,'2017-11-10',23422.21),(219,'2017-11-13',23439.70),(220,'2017-11-14',23409.47),(221,'2017-11-15',23271.28),(222,'2017-11-16',23458.36),(223,'2017-11-17',23358.24),(224,'2017-11-20',23430.33),(225,'2017-11-21',23590.83),(226,'2017-11-22',23526.18),(227,'2017-11-24',23557.99),(228,'2017-11-27',23580.78),(229,'2017-11-28',23836.71),(230,'2017-11-29',23940.68),(231,'2017-11-30',24272.35),(232,'2017-12-01',24231.59),(233,'2017-12-04',24290.05),(234,'2017-12-05',24180.64),(235,'2017-12-06',24140.91),(236,'2017-12-07',24211.48),(237,'2017-12-08',24329.16),(238,'2017-12-11',24386.03),(239,'2017-12-12',24504.80),(240,'2017-12-13',24585.43),(241,'2017-12-14',24508.66),(242,'2017-12-15',24651.74),(243,'2017-12-18',24792.20),(244,'2017-12-19',24754.75),(245,'2017-12-20',24726.65),(246,'2017-12-21',24782.29),(247,'2017-12-22',24754.06),(248,'2017-12-26',24746.21),(249,'2017-12-27',24774.30),(250,'2017-12-28',24837.51),(251,'2017-12-29',24719.22);
/*!40000 ALTER TABLE `finance` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `politics`
--

DROP TABLE IF EXISTS `politics`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `politics` (
  `politics_id` int(9) NOT NULL,
  `political_figure` varchar(45) DEFAULT NULL,
  `interview_date` date DEFAULT NULL,
  `interviewer_staff_id` int(9) DEFAULT NULL,
  PRIMARY KEY (`politics_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `politics`
--

LOCK TABLES `politics` WRITE;
/*!40000 ALTER TABLE `politics` DISABLE KEYS */;
INSERT INTO `politics` VALUES (1,'michael bennet','2017-11-26',4),(2,'joe biden','2017-11-30',4),(3,'michael bloomberg','2017-12-01',4),(4,'cory booker','2017-12-04',4),(5,'pete buttigieg','2017-12-06',4),(6,'julian castro','2017-12-08',4),(7,'john delaney','2017-12-09',4),(8,'tulsi gabbard','2017-12-10',4),(9,'amy klobuchar','2017-12-11',4),(10,'deval patrick','2017-12-13',4);
/*!40000 ALTER TABLE `politics` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `reports`
--

DROP TABLE IF EXISTS `reports`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `reports` (
  `report_id` int(11) NOT NULL,
  `report_length` time DEFAULT NULL,
  `weather_id` int(11) DEFAULT NULL,
  `politics_id` int(11) DEFAULT NULL,
  `finance_id` int(11) DEFAULT NULL,
  `sport_id` int(11) DEFAULT NULL,
  PRIMARY KEY (`report_id`),
  KEY `fk_reports_weather1` (`weather_id`),
  KEY `fk_reports_politics1` (`politics_id`),
  KEY `fk_reports_finance1` (`finance_id`),
  KEY `fk_reports_sports1` (`sport_id`),
  CONSTRAINT `fk_reports_finance1` FOREIGN KEY (`finance_id`) REFERENCES `finance` (`finance_id`),
  CONSTRAINT `fk_reports_politics1` FOREIGN KEY (`politics_id`) REFERENCES `politics` (`politics_id`),
  CONSTRAINT `fk_reports_sports1` FOREIGN KEY (`sport_id`) REFERENCES `sports` (`sport_id`),
  CONSTRAINT `fk_reports_weather1` FOREIGN KEY (`weather_id`) REFERENCES `weather` (`weather_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `reports`
--

LOCK TABLES `reports` WRITE;
/*!40000 ALTER TABLE `reports` DISABLE KEYS */;
INSERT INTO `reports` VALUES (1,'01:00:00',331,1,NULL,3),(2,'00:15:00',332,NULL,228,4),(3,'00:15:00',333,NULL,229,NULL),(4,'00:05:00',334,NULL,230,5),(5,'01:00:00',335,2,231,6),(6,'01:00:00',336,3,232,7),(7,'00:30:00',337,NULL,NULL,8),(8,'00:15:00',338,NULL,NULL,NULL),(9,'01:00:00',339,4,233,9),(10,'00:05:00',340,NULL,234,10);
/*!40000 ALTER TABLE `reports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `scheduling`
--

DROP TABLE IF EXISTS `scheduling`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `scheduling` (
  `schedule_id` int(11) NOT NULL,
  `staff_id` int(11) DEFAULT NULL,
  `report_id` int(11) DEFAULT NULL,
  `report_date` date DEFAULT NULL,
  `report_start` time DEFAULT NULL,
  `report_end` time DEFAULT NULL,
  PRIMARY KEY (`schedule_id`),
  KEY `fk_scheduling_staff1` (`staff_id`),
  KEY `fk_scheduling_reports1` (`report_id`),
  CONSTRAINT `fk_scheduling_reports1` FOREIGN KEY (`report_id`) REFERENCES `reports` (`report_id`),
  CONSTRAINT `fk_scheduling_staff1` FOREIGN KEY (`staff_id`) REFERENCES `staff` (`staff_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `scheduling`
--

LOCK TABLES `scheduling` WRITE;
/*!40000 ALTER TABLE `scheduling` DISABLE KEYS */;
INSERT INTO `scheduling` VALUES (1,2,1,'2017-11-26','18:00:00','19:00:00'),(2,4,2,'2017-11-27','07:45:00','08:00:00'),(3,3,3,'2017-11-28','12:00:00','12:15:00'),(4,6,4,'2017-11-29','16:55:00','17:00:00'),(5,2,5,'2017-11-30','18:00:00','19:00:00'),(6,2,6,'2017-12-01','18:00:00','19:00:00'),(7,5,7,'2017-12-02','09:00:00','09:30:00'),(8,5,8,'2017-12-03','07:45:00','08:00:00'),(9,2,9,'2017-12-04','18:00:00','19:00:00'),(10,6,10,'2017-12-05','16:55:00','17:00:00');
/*!40000 ALTER TABLE `scheduling` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `sports`
--

DROP TABLE IF EXISTS `sports`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `sports` (
  `sport_id` int(9) NOT NULL,
  `sport_date` date DEFAULT NULL,
  `sport_type` varchar(45) DEFAULT NULL,
  `home_team` varchar(45) DEFAULT NULL,
  `away_team` varchar(45) DEFAULT NULL,
  `home_score` int(3) DEFAULT NULL,
  `away_score` int(3) DEFAULT NULL,
  PRIMARY KEY (`sport_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `sports`
--

LOCK TABLES `sports` WRITE;
/*!40000 ALTER TABLE `sports` DISABLE KEYS */;
INSERT INTO `sports` VALUES (1,'2017-11-23','hockey','avalanche','maple leafs',3,5),(2,'2017-11-24','football','bills','broncos',20,3),(3,'2017-11-26','basketball','nuggets','wizards',117,104),(4,'2017-11-27','hockey','avalanche','oilers',3,1),(5,'2017-11-29','hockey','blackhawks','avalanche',2,5),(6,'2017-11-30','hockey','avalanche','blackhawks',7,3),(7,'2017-12-01','basketball','kings','nuggets',100,97),(8,'2017-12-02','football','broncos','chargers',23,20),(9,'2017-12-04','basketball','nuggets','lakers',96,105),(10,'2017-12-05','hockey','maple leafs','avalanche',1,3);
/*!40000 ALTER TABLE `sports` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `staff`
--

DROP TABLE IF EXISTS `staff`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `staff` (
  `staff_id` int(9) NOT NULL,
  `first_name` varchar(45) DEFAULT NULL,
  `last_name` varchar(45) DEFAULT NULL,
  `email` varchar(45) DEFAULT NULL,
  `phone` int(10) DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `job_title` varchar(40) DEFAULT NULL,
  PRIMARY KEY (`staff_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `staff`
--

LOCK TABLES `staff` WRITE;
/*!40000 ALTER TABLE `staff` DISABLE KEYS */;
INSERT INTO `staff` VALUES (1,'john','smith','jsmith@news.com',1717171077,'2005-10-12','producer'),(2,'james','williams','jwilliams@news.com',1717171627,'2007-01-31','senior news anchor'),(3,'robert','johnson','rjohnson@news.com',1717172787,'2011-03-03','sports anchor'),(4,'william','brown','wbrown@news.com',1717173747,'2016-05-06','interviewer'),(5,'michael','jones','mjones@news.com',1717174777,'2016-07-07','finance anchor'),(6,'mary','miller','mmiller@news.com',1717175657,'2016-07-07','meteorologist '),(7,'patricia','wilson','pwilson@news.com',1717176597,'2016-10-03','politics panelist'),(8,'jennifer','jones','jjones@news.com',1717177537,'2017-04-23','politics panelist'),(9,'linda','davis','ldavis@news.com',1717178477,'2017-08-30','junior news anchor'),(10,'susan','anderson','sanderson@news.com',1717179417,'2017-09-20','it staff');
/*!40000 ALTER TABLE `staff` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `weather`
--

DROP TABLE IF EXISTS `weather`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `weather` (
  `weather_id` int(9) NOT NULL,
  `weather_date` date DEFAULT NULL,
  `high_tmep` int(11) DEFAULT NULL,
  `low_temp` int(11) DEFAULT NULL,
  `precipitation` decimal(10,2) DEFAULT NULL,
  PRIMARY KEY (`weather_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `weather`
--

LOCK TABLES `weather` WRITE;
/*!40000 ALTER TABLE `weather` DISABLE KEYS */;
INSERT INTO `weather` VALUES (1,'2017-01-01',46,19,0.00),(2,'2017-01-02',49,21,0.00),(3,'2017-01-03',31,13,0.02),(4,'2017-01-04',24,6,0.19),(5,'2017-01-05',8,2,0.72),(6,'2017-01-06',31,-7,0.00),(7,'2017-01-07',31,3,0.00),(8,'2017-01-08',56,10,0.00),(9,'2017-01-09',58,29,-999.00),(10,'2017-01-10',52,32,0.05),(11,'2017-01-11',53,26,0.01),(12,'2017-01-12',43,24,0.01),(13,'2017-01-13',42,18,0.01),(14,'2017-01-14',42,22,0.00),(15,'2017-01-15',38,23,-999.00),(16,'2017-01-16',38,29,0.37),(17,'2017-01-17',48,19,0.00),(18,'2017-01-18',54,21,0.00),(19,'2017-01-19',55,27,0.00),(20,'2017-01-20',48,31,0.00),(21,'2017-01-21',42,20,0.00),(22,'2017-01-22',48,24,0.00),(23,'2017-01-23',51,27,0.00),(24,'2017-01-24',45,23,0.03),(25,'2017-01-25',29,13,-999.00),(26,'2017-01-26',32,9,0.00),(27,'2017-01-27',44,9,0.00),(28,'2017-01-28',50,19,0.00),(29,'2017-01-29',61,31,0.00),(30,'2017-01-30',61,41,0.00),(31,'2017-01-31',63,36,0.00),(32,'2017-02-01',57,23,0.01),(33,'2017-02-02',24,19,0.21),(34,'2017-02-03',29,13,-999.00),(35,'2017-02-04',56,19,0.00),(36,'2017-02-05',60,31,0.00),(37,'2017-02-06',61,35,0.00),(38,'2017-02-07',63,43,-999.00),(39,'2017-02-08',56,40,0.00),(40,'2017-02-09',68,54,0.00),(41,'2017-02-10',76,57,0.00),(42,'2017-02-11',66,44,-999.00),(43,'2017-02-12',50,31,0.00),(44,'2017-02-13',50,28,0.00),(45,'2017-02-14',51,23,0.00),(46,'2017-02-15',67,26,0.00),(47,'2017-02-16',73,37,0.00),(48,'2017-02-17',67,28,0.00),(49,'2017-02-18',64,35,0.00),(50,'2017-02-19',61,34,0.00),(51,'2017-02-20',62,33,-999.00),(52,'2017-02-21',70,33,0.00),(53,'2017-02-22',61,40,0.00),(54,'2017-02-23',51,21,0.41),(55,'2017-02-24',31,14,0.10),(56,'2017-02-25',35,10,-999.00),(57,'2017-02-26',41,11,0.00),(58,'2017-02-27',49,14,0.00),(59,'2017-02-28',48,27,0.00),(60,'2017-03-01',-998,-998,-998.00),(61,'2017-03-01',45,21,0.00),(62,'2017-03-02',53,23,0.00),(63,'2017-03-03',64,31,0.00),(64,'2017-03-04',70,33,0.00),(65,'2017-03-05',64,40,0.00),(66,'2017-03-06',57,29,-999.00),(67,'2017-03-07',51,25,0.00),(68,'2017-03-08',66,36,0.00),(69,'2017-03-09',71,41,0.00),(70,'2017-03-10',62,23,0.00),(71,'2017-03-11',56,37,-999.00),(72,'2017-03-12',62,32,0.00),(73,'2017-03-13',58,26,0.00),(74,'2017-03-14',72,42,0.00),(75,'2017-03-15',78,38,0.00),(76,'2017-03-16',77,50,0.00),(77,'2017-03-17',70,41,0.00),(78,'2017-03-18',80,36,0.00),(79,'2017-03-19',78,53,0.00),(80,'2017-03-20',77,52,0.00),(81,'2017-03-21',69,36,-999.00),(82,'2017-03-22',69,33,0.00),(83,'2017-03-23',75,43,0.00),(84,'2017-03-24',62,37,0.10),(85,'2017-03-25',63,30,0.00),(86,'2017-03-26',62,39,0.21),(87,'2017-03-27',61,32,0.00),(88,'2017-03-28',58,41,0.57),(89,'2017-03-29',58,35,0.21),(90,'2017-03-30',66,32,0.00),(91,'2017-03-31',60,35,0.36),(92,'2017-04-01',41,31,0.32),(93,'2017-04-02',63,30,0.00),(94,'2017-04-03',58,29,0.01),(95,'2017-04-04',54,30,0.91),(96,'2017-04-05',55,21,0.34),(97,'2017-04-06',65,33,0.00),(98,'2017-04-07',75,39,0.00),(99,'2017-04-08',74,39,0.00),(100,'2017-04-09',70,39,0.00),(101,'2017-04-10',57,27,0.00),(102,'2017-04-11',67,29,0.00),(103,'2017-04-12',73,36,0.00),(104,'2017-04-13',77,37,0.00),(105,'2017-04-14',77,41,0.00),(106,'2017-04-15',73,39,0.00),(107,'2017-04-16',70,36,0.00),(108,'2017-04-17',76,36,0.00),(109,'2017-04-18',77,42,0.00),(110,'2017-04-19',72,43,0.00),(111,'2017-04-20',62,35,0.03),(112,'2017-04-21',52,39,0.36),(113,'2017-04-22',57,36,0.06),(114,'2017-04-23',74,34,0.00),(115,'2017-04-24',69,46,-999.00),(116,'2017-04-25',59,36,0.10),(117,'2017-04-26',62,27,0.01),(118,'2017-04-27',53,34,0.18),(119,'2017-04-28',53,31,0.01),(120,'2017-04-29',37,27,0.80),(121,'2017-04-30',58,21,0.02),(122,'2017-05-01',64,36,0.00),(123,'2017-05-02',63,42,-999.00),(124,'2017-05-03',57,35,0.16),(125,'2017-05-04',72,32,0.00),(126,'2017-05-05',78,42,0.00),(127,'2017-05-06',85,44,0.00),(128,'2017-05-07',79,54,0.05),(129,'2017-05-08',71,46,0.01),(130,'2017-05-09',62,46,0.65),(131,'2017-05-10',62,49,0.28),(132,'2017-05-11',64,45,0.52),(133,'2017-05-12',78,41,0.00),(134,'2017-05-13',83,43,0.00),(135,'2017-05-14',82,46,0.00),(136,'2017-05-15',77,46,0.00),(137,'2017-05-16',71,49,0.04),(138,'2017-05-17',73,38,0.01),(139,'2017-05-18',60,31,3.11),(140,'2017-05-19',43,32,0.28),(141,'2017-05-20',63,30,0.00),(142,'2017-05-21',67,35,-999.00),(143,'2017-05-22',69,38,0.54),(144,'2017-05-23',65,35,0.16),(145,'2017-05-24',82,37,0.00),(146,'2017-05-25',74,56,-999.00),(147,'2017-05-26',67,44,0.27),(148,'2017-05-27',65,46,0.18),(149,'2017-05-28',72,37,0.00),(150,'2017-05-29',68,43,0.02),(151,'2017-05-30',74,42,0.00),(152,'2017-05-31',80,44,0.01),(153,'2017-06-01',79,47,0.01),(154,'2017-06-02',77,49,0.05),(155,'2017-06-03',77,47,0.00),(156,'2017-06-04',81,47,0.00),(157,'2017-06-05',83,50,0.00),(158,'2017-06-06',78,52,0.00),(159,'2017-06-07',81,50,0.01),(160,'2017-06-08',81,49,0.02),(161,'2017-06-09',93,50,-999.00),(162,'2017-06-10',91,61,0.00),(163,'2017-06-11',81,58,0.00),(164,'2017-06-12',88,56,0.00),(165,'2017-06-13',88,50,0.00),(166,'2017-06-14',86,51,0.00),(167,'2017-06-15',89,51,0.00),(168,'2017-06-16',92,54,0.00),(169,'2017-06-17',90,63,0.00),(170,'2017-06-18',85,53,0.00),(171,'2017-06-19',85,52,0.00),(172,'2017-06-20',97,53,0.00),(173,'2017-06-21',98,63,0.07),(174,'2017-06-22',93,69,-999.00),(175,'2017-06-23',75,45,0.23),(176,'2017-06-24',76,44,0.00),(177,'2017-06-25',73,49,0.00),(178,'2017-06-26',86,49,0.00),(179,'2017-06-27',95,52,0.00),(180,'2017-06-28',91,55,0.00),(181,'2017-06-29',83,53,0.01),(182,'2017-06-30',77,51,0.05),(183,'2017-07-01',87,49,0.00),(184,'2017-07-02',91,53,-999.00),(185,'2017-07-03',90,55,-999.00),(186,'2017-07-04',92,55,-999.00),(187,'2017-07-05',96,55,0.00),(188,'2017-07-06',97,58,0.00),(189,'2017-07-07',89,61,0.01),(190,'2017-07-08',88,57,-999.00),(191,'2017-07-09',94,57,0.00),(192,'2017-07-10',93,60,-999.00),(193,'2017-07-11',94,61,0.00),(194,'2017-07-12',85,68,-999.00),(195,'2017-07-13',87,53,0.02),(196,'2017-07-14',90,57,0.00),(197,'2017-07-15',86,58,-999.00),(198,'2017-07-16',87,55,0.00),(199,'2017-07-17',93,57,-999.00),(200,'2017-07-18',91,61,-999.00),(201,'2017-07-19',100,61,0.01),(202,'2017-07-20',89,61,-999.00),(203,'2017-07-21',95,61,0.21),(204,'2017-07-22',88,57,0.07),(205,'2017-07-23',91,57,0.00),(206,'2017-07-24',96,57,0.00),(207,'2017-07-25',92,62,0.02),(208,'2017-07-26',79,61,0.07),(209,'2017-07-27',86,61,0.85),(210,'2017-07-28',89,56,0.03),(211,'2017-07-29',79,64,0.01),(212,'2017-07-30',82,57,0.00),(213,'2017-07-31',88,54,-999.00),(214,'2017-08-01',88,56,0.00),(215,'2017-08-02',85,53,0.00),(216,'2017-08-03',79,54,0.09),(217,'2017-08-04',85,51,0.12),(218,'2017-08-05',83,59,0.03),(219,'2017-08-06',74,54,0.15),(220,'2017-08-07',69,54,0.77),(221,'2017-08-08',73,51,0.24),(222,'2017-08-09',76,52,-999.00),(223,'2017-08-10',76,52,0.10),(224,'2017-08-11',77,51,0.01),(225,'2017-08-12',80,52,-999.00),(226,'2017-08-13',85,55,0.03),(227,'2017-08-14',86,56,-999.00),(228,'2017-08-15',81,53,0.00),(229,'2017-08-16',79,52,0.05),(230,'2017-08-17',86,50,0.01),(231,'2017-08-18',87,51,0.00),(232,'2017-08-19',94,55,-999.00),(233,'2017-08-20',89,61,-999.00),(234,'2017-08-21',85,56,0.00),(235,'2017-08-22',81,52,0.00),(236,'2017-08-23',87,58,-999.00),(237,'2017-08-24',86,53,0.01),(238,'2017-08-25',89,54,0.00),(239,'2017-08-26',91,56,0.00),(240,'2017-08-27',89,59,0.00),(241,'2017-08-28',90,53,0.00),(242,'2017-08-29',91,56,0.00),(243,'2017-08-30',89,55,0.00),(244,'2017-08-31',85,55,0.01),(245,'2017-09-01',87,57,0.00),(246,'2017-09-02',89,55,0.00),(247,'2017-09-03',97,56,0.00),(248,'2017-09-04',90,58,0.00),(249,'2017-09-05',79,56,0.00),(250,'2017-09-06',80,45,0.00),(251,'2017-09-07',85,48,0.00),(252,'2017-09-08',84,52,0.00),(253,'2017-09-09',89,55,-999.00),(254,'2017-09-10',89,56,-999.00),(255,'2017-09-11',85,60,-999.00),(256,'2017-09-12',90,55,0.00),(257,'2017-09-13',90,59,0.00),(258,'2017-09-14',89,59,0.00),(259,'2017-09-15',83,51,0.00),(260,'2017-09-16',73,46,0.02),(261,'2017-09-17',72,43,0.01),(262,'2017-09-18',83,47,0.00),(263,'2017-09-19',87,49,0.00),(264,'2017-09-20',81,40,0.00),(265,'2017-09-21',89,43,0.00),(266,'2017-09-22',77,43,-999.00),(267,'2017-09-23',65,46,0.64),(268,'2017-09-24',49,44,0.54),(269,'2017-09-25',51,40,0.10),(270,'2017-09-26',59,41,-999.00),(271,'2017-09-27',56,48,0.08),(272,'2017-09-28',56,47,0.37),(273,'2017-09-29',59,42,0.09),(274,'2017-09-30',66,41,0.07),(275,'2017-10-01',68,50,0.04),(276,'2017-10-02',58,37,1.12),(277,'2017-10-03',55,32,0.04),(278,'2017-10-04',68,37,0.00),(279,'2017-10-05',69,43,0.00),(280,'2017-10-06',69,45,0.00),(281,'2017-10-07',77,48,0.00),(282,'2017-10-08',71,44,0.00),(283,'2017-10-09',52,31,0.92),(284,'2017-10-10',56,25,0.00),(285,'2017-10-11',70,31,0.00),(286,'2017-10-12',78,40,0.00),(287,'2017-10-13',63,34,0.00),(288,'2017-10-14',61,35,0.00),(289,'2017-10-15',62,27,0.00),(290,'2017-10-16',73,36,0.00),(291,'2017-10-17',79,37,0.00),(292,'2017-10-18',77,55,0.00),(293,'2017-10-19',75,38,0.00),(294,'2017-10-20',78,46,0.00),(295,'2017-10-21',66,35,0.00),(296,'2017-10-22',70,32,0.00),(297,'2017-10-23',64,40,0.00),(298,'2017-10-24',63,29,0.00),(299,'2017-10-25',85,42,0.00),(300,'2017-10-26',71,31,0.11),(301,'2017-10-27',44,20,0.03),(302,'2017-10-28',60,34,0.00),(303,'2017-10-29',74,40,0.00),(304,'2017-10-30',58,28,0.14),(305,'2017-10-31',52,26,0.02),(306,'2017-11-01',72,39,0.00),(307,'2017-11-02',63,34,0.00),(308,'2017-11-03',58,34,0.00),(309,'2017-11-04',69,35,0.00),(310,'2017-11-05',52,35,0.02),(311,'2017-11-06',43,33,-999.00),(312,'2017-11-07',39,24,0.39),(313,'2017-11-08',49,19,0.07),(314,'2017-11-09',41,29,0.00),(315,'2017-11-10',57,25,0.00),(316,'2017-11-11',60,32,0.00),(317,'2017-11-12',53,26,0.00),(318,'2017-11-13',72,34,0.00),(319,'2017-11-14',70,41,0.00),(320,'2017-11-15',60,26,0.00),(321,'2017-11-16',74,31,0.00),(322,'2017-11-17',64,44,0.02),(323,'2017-11-18',51,24,0.04),(324,'2017-11-19',55,25,0.00),(325,'2017-11-20',70,42,0.00),(326,'2017-11-21',58,37,0.03),(327,'2017-11-22',71,31,0.00),(328,'2017-11-23',72,45,0.00),(329,'2017-11-24',72,49,-999.00),(330,'2017-11-25',63,34,0.00),(331,'2017-11-26',73,35,0.00),(332,'2017-11-27',76,56,0.00),(333,'2017-11-28',64,34,-999.00),(334,'2017-11-29',67,26,0.00),(335,'2017-11-30',55,26,0.00),(336,'2017-12-01',64,32,0.00),(337,'2017-12-02',61,32,0.00),(338,'2017-12-03',66,35,0.00),(339,'2017-12-04',58,27,0.00),(340,'2017-12-05',51,14,0.00),(341,'2017-12-06',41,19,0.00),(342,'2017-12-07',36,13,0.00),(343,'2017-12-08',60,32,0.00),(344,'2017-12-09',64,32,0.00),(345,'2017-12-10',62,32,0.00),(346,'2017-12-11',60,33,0.00),(347,'2017-12-12',68,28,0.00),(348,'2017-12-13',59,42,0.00),(349,'2017-12-14',45,23,0.18),(350,'2017-12-15',62,19,0.00),(351,'2017-12-16',58,36,0.00),(352,'2017-12-17',40,29,0.00),(353,'2017-12-18',54,21,0.00),(354,'2017-12-19',51,28,0.00),(355,'2017-12-20',66,31,0.00),(356,'2017-12-21',53,17,0.22),(357,'2017-12-22',41,7,0.00),(358,'2017-12-23',37,11,-999.00),(359,'2017-12-24',26,-2,0.25),(360,'2017-12-25',24,11,-999.00),(361,'2017-12-26',17,8,0.02),(362,'2017-12-27',52,2,-999.00),(363,'2017-12-28',51,27,0.00),(364,'2017-12-29',63,24,0.00),(365,'2017-12-30',53,11,-999.00),(366,'2017-12-31',27,12,0.01);
/*!40000 ALTER TABLE `weather` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2019-12-08 17:02:12
#Questions on Weather and Finance
select * from weather
order by low_temp;
select * from finance;
select * from finance f
join reports r on f.finance_id = r.finance_id
join weather w on r.weather_id = w.weather_id;

#Does a rainy day make the market (Dow Jones) worse?
UPDATE weather
SET precipitation = '0'
WHERE precipitation < '0';

DELETE FROM weather WHERE high_tmep < '-50';

DELETE FROM weather WHERE low_temp < '-50';
				

SELECT f.djia_returns, avg(w.precipitation) from finance f
#join reports r on f.finance_id = r.finance_id
join weather w on f.djia_date = w.weather_date
#group by r.report_id
group by f.djia_returns
order by avg(f.djia_returns);
#drop -999 get averages or changes positive or negative
select rainy(precipitation) from weather;

SELECT avg(f.djia_returns) as 'Average DJIA returns', rainy(precipitation) AS 'Precipitation' from finance f
#join reports r on f.finance_id = r.finance_id
join weather w on f.djia_date = w.weather_date
group by rainy(precipitation);


select * from sports;

#Is a home team less likely to win if it is warmer outside?
select (select count(*) from sports s
join weather w on s.sport_date = w.weather_date
where s.home_score > s.away_score) as 'Home Team Wins',
(select count(*) from sports s
join weather w on s.sport_date = w.weather_date
where s.home_score < s.away_score) as 'Home Team Losses', temp(w.high_tmep) AS 'Temperature' from sports s
join weather w on s.sport_date = w.weather_date
group by temp(w.high_tmep);

#The temperature was warm for all games. There were six home team wins and four home team losses.

select *, w.high_tmep from sports s
join weather w on s.sport_date = w.weather_date
where s.home_score > s.away_score;

select *, w.high_tmep from sports s
join weather w on s.sport_date = w.weather_date
where s.home_score < s.away_score;

#group by w.high_tmep; 
#average temperature range

select high_tmep-low_temp from weather;

select count(*), w.high_tmep from sports s
join weather w on s.sport_date = w.weather_date
where s.home_score < s.away_score
group by w.high_tmep; 

SELECT AVG(high_tmep) from weather;
SELECT AVG(low_temp) from weather;

SELECT avg(f.djia_returns) as 'Average DJIA returns', temp(high_tmep) AS 'Temperature' from finance f
#join reports r on f.finance_id = r.finance_id
join weather w on f.djia_date = w.weather_date
group by temp(high_tmep)
order by avg(f.djia_returns);

#more wins on warmer average days

#does a low or high temp more positively affect the market?
SELECT  w.weather_date, f.djia_returns, w.high_tmep, w.low_temp, ((w.high_tmep + w.low_temp)/2) AS 'Average Temp' from finance f
#join reports r on f.finance_id = r.finance_id
join weather w on f.djia_date = w.weather_date
#group by r.report_id
order by (w.high_tmep + w.low_temp)/2;

select temp(high_tmep, low_temp) from weather;

select * from weather;

SELECT avg(f.djia_returns) as 'Average DJIA returns', temp(high_tmep) AS 'Temperature' from finance f
#join reports r on f.finance_id = r.finance_id
join weather w on f.djia_date = w.weather_date
group by temp(high_tmep)
order by avg(f.djia_returns);

#weather trigger
drop trigger if exists weather_check; 
delimiter //
CREATE TRIGGER weather_check BEFORE UPDATE ON weather
       FOR EACH ROW
       BEGIN
           IF NEW.precipitation < 0 THEN
               SET NEW.precipitation = 0;
           END IF;
           IF NEW.high_tmep < -50 THEN
                DELETE FROM weather WHERE high_tmep < '-50';
           END IF;
           IF NEW.low_temp < -50 THEN
				DELETE FROM weather WHERE low_temp < '-50';
           END IF;
       END //
delimiter ;

insert into weather(weather_id, high_tmep, low_temp, precipitation)
VALUES ('100000000', '-500','-500','55');

DELETE FROM weather WHERE weather_id = '100000000';



DELIMITER //
CREATE FUNCTION rainy (precip decimal(10,2)) RETURNS VARCHAR(20)
DETERMINISTIC
BEGIN
	DECLARE rainornot VARCHAR(20);

    case
	WHEN precip > 0 THEN SET rainornot = 'YES';
    ELSE SET rainornot = 'NO';
    end case;
    
	RETURN (rainornot);

END //
DELIMITER ;

select rainy(precipitation) from weather;

drop function if exists temp;

DELIMITER //
CREATE FUNCTION temp (high int(11)) RETURNS VARCHAR(20)
DETERMINISTIC
BEGIN
	DECLARE hotorcold VARCHAR(20);

    case
	WHEN high >= 80 THEN SET hotorcold = 'HOT';
    WHEN high <= 80 AND high >= 50 THEN SET hotorcold = 'WARM';
    WHEN high < 50 AND high >= 32 THEN SET hotorcold = 'COOL';
    WHEN high < 32 THEN SET hotorcold = 'COLD';
    end case;
    
	RETURN (hotorcold);

END //
DELIMITER ;

select temp(high_tmep) from weather;
select high_tmep from weather;
